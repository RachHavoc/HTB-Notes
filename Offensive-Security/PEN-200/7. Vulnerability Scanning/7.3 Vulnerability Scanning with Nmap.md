### NSE Vulnerability Scripts 

[_NSE Documentation_](https://nmap.org/nsedoc)

On Kali, scripts located at `/usr/share/nmap/scripts`

`.nse` - actual script 
`script.db`- index for scripts

Locate scripts in the "vuln" category

```shell
kali@kali:~$ cd /usr/share/nmap/scripts/

kali@kali:/usr/share/nmap/scripts$ cat script.db  | grep "\"vuln\""
Entry { filename = "afp-path-vuln.nse", categories = { "exploit", "intrusive", "vuln", } }
Entry { filename = "broadcast-avahi-dos.nse", categories = { "broadcast", "dos", "intrusive", "vuln", } }
Entry { filename = "clamav-exec.nse", categories = { "exploit", "vuln", } }
Entry { filename = "distcc-cve2004-2687.nse", categories = { "exploit", "intrusive", "vuln", } }
Entry { filename = "dns-update.nse", categories = { "intrusive", "vuln", } }
...
```

Specify script absolute path, category, comma-separated list of categories, boolean expression with the `--script` flag. 

Using NSE's "vuln" category scripts against the SAMBA machine

`--script "vuln`- NSE script with vuln argument
`-sV`- service detection
`-p`- specify port 

```
kali@kali:~$ sudo nmap -sV -p 443 --script "vuln" 192.168.50.124
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org )
...
PORT    STATE SERVICE VERSION
443/tcp open  http    Apache httpd 2.4.49 ((Unix))
...
| vulners: 
|   cpe:/a:apache:http_server:2.4.49:
...
        https://vulners.com/githubexploit/DF57E8F1-FE21-5EB9-8FC7-5F2EA267B09D	*EXPLOIT*
|     	CVE-2021-41773	4.3	https://vulners.com/cve/CVE-2021-41773
...
|_http-server-header: Apache/2.4.49 (Unix)
MAC Address: 00:0C:29:C7:81:EA (VMware)
```

### Working with NSE scripts

Using a specific CVE. 

Google CVE with .nse extension. 

Download script from GitHub and save it as `/usr/share/nmap/scripts/http-vuln-cve2021-41773.nse`

Update `script.db` with `--script-updatedb`

```shell
kali@kali:~$ sudo cp /home/kali/Downloads/http-vuln-cve-2021-41773.nse /usr/share/nmap/scripts/http-vuln-cve2021-41773.nse

kali@kali:~$ sudo nmap --script-updatedb
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org )
NSE: Updating rule database.
NSE: Script Database updated successfully.
Nmap done: 0 IP addresses (0 hosts up) scanned in 0.54 seconds
```

Use the script:

`sudo nmap -sV -p 443 --script "http-vuln-cve2021-41773" 192.168.50.124`