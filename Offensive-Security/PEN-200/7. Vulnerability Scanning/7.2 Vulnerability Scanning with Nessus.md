Download [Nessus](https://www.tenable.com/downloads/nessus) for the **Linux - Ubuntu - arch64** platform

Verifying the checksum 

```
kali@kali:~$ cd ~/Downloads

kali@kali:~/Downloads$ echo "4987776fef98bb2a72515abc0529e90572778b1d7aeeb1939179ff1f4de1440d Nessus-10.5.0-debian10_amd64.deb" > sha256sum_nessus

kali@kali:~/Downloads$ sha256sum -c sha256sum_nessus
Nessus-10.5.0-debian10_amd64.deb: OK
```

Checksums match and can install with 

```
kali@kali:~/Downloads$ sudo apt install ./Nessus-10.5.0-debian10_amd64.deb
...
Preparing to unpack .../Nessus-10.5.0-debian10_amd64.deb ...
Unpacking nessus (10.5.0) ...
Setting up nessus (10.5.0) ...
...
Unpacking Nessus Scanner Core Components...
 - You can start Nessus Scanner by typing /bin/systemctl start nessusd.service
 - Then go to https://kali:8834/ to configure your scanner
```

Starting Nessus

```
kali@kali:~/Downloads$ sudo systemctl start nessusd.service
```

Navigate to https://127.0.0.1:8834

### Nessus Components

Configuration options:
[Nessus documentation](https://docs.tenable.com/nessus/Content/Settings.htm)

Scan Templates: 
Discovery, Vulnerabilities, Compliance 

Scanning options:

1. Basic Network Scan (Recommended) - performs full scan with predefined settings
2. Advanced Scan - No predefined settings. For custom scan. 
3. Advanced Dynamic Scan - No predefined settings or recommendations. Do not need to select plugins manually. 

Things to note: 

* Default settings do not scan UDP ports. Enabling UDP scanning will increase scan time. 
* Turn off host discovery to save time `Discovery > Host Discovery > Ping remote host OFF`

### Reviewing nessus results

Click on a host IP to get list of vulnerabilities. 

VPR Top Threats list will include the top ten vulnerabilities of the scan. 
[_Vulnerability Priority Rating_](https://www.tenable.com/blog/what-is-vpr-and-how-is-it-different-from-cvss) (VPR)

If Nessus detects a vulnerability, a remediation is provided on Remediations tab. 

Create a PDF report by clicking Reports tab. 

Use `Detailed Vulnerabilities by Host` template. 

### Performing an Authenticated Vulnerability Scan 

Use the `Credentialed Patch Audit` scan template. This scan will reveal missing OS patches and outdated apps.

![Figure 31: Basic Settings for the Authenticated Scan](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/591edc2b93b202ac2119f79f7041e420-vulnscan_nessusAuthTargets5R.png)
Figure 31: Basic Settings for the Authenticated Scan

Click on `Credentials` tab, Select `SSH` in `Host` category. On `Authentication method` dropdown, select `password`, enter username: `offsec` password: `lab`.  Select `sudo` for the `Elevate privileges with` option. Enter `root` as sudo user and `lab` as password. 

![Figure 32: SSH and Sudo Credentials for the Authenticated Scan](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fe9117a90c680eed613cf9c3e8c59dbf-vulnscan_nessusAuthSshCredsR.png)

Use [_Server Message Block_](https://en.wikipedia.org/wiki/Server_Message_Block) (SMB) and [_Windows Management Instrumentation_](https://en.wikipedia.org/wiki/Windows_Management_Instrumentation) (WMI) to perform authenticated vulnerability scans against Windows targets.

Note:
* Add exception for authenticated scan on target AV's. 
* Configure UAC to allow Nessus to disable it. 
More info: [_Tenable Documentation_](https://docs.tenable.com/nessus/Content/CredentialedChecksOnWindows.htm)
